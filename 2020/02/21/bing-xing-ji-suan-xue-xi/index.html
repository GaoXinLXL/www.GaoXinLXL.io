<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="鹰击长空，鱼翔浅底，万类霜天竞自由">
    

    <!--Author-->
    
        <meta name="author" content="GaoXin">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="并行计算学习"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="鹰击长空，鱼翔浅底，万类霜天竞自由" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="GaoXin"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

    
        <meta name="twitter:card" content="summary" />
    
    
    

    <!-- Title -->
    
    <title>并行计算学习 - GaoXin</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.2/css/bootstrap.min.css" integrity="sha384-y3tfxAZXuh4HwSYylfB+J125MxIs6mR5FOHamPBG064zB+AFeWH94NdvaCBm8qnd" crossorigin="anonymous">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Google Analytics -->
    


<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<div class="bg-gradient"></div>
<div class="bg-pattern"></div>

<!-- Menu -->
<!--Menu Links and Overlay-->
<div class="menu-bg">
    <div class="menu-container">
        <ul>
            
            <li class="menu-item">
                <a href="/">
                    Home
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/archives">
                    Archives
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/about.html">
                    About
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/tags">
                    Tags
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/categories">
                    Categories
                </a>
            </li>
            
            <li class="menu-item">
                <a href="/contact.html">
                    Contact
                </a>
            </li>
            
        </ul>
    </div>
</div>

<!--Hamburger Icon-->
<nav>
    <a href="#menu"></a>
</nav>

<div class="container">

    <!-- Main Content -->
    <div class="row">
    <div class="col-sm-12">

        <!--Title and Logo-->
        <header>
    <div class="logo">
        <a href="/"><i class="logo-icon fa fa-cube" aria-hidden="true"></i></a>
        
    </div>
</header>

        <section class="main">
            
<div class="post">

    <div class="post-header">
        <h1 class="title">
            <a href="/2020/02/21/bing-xing-ji-suan-xue-xi/">
                并行计算学习
            </a>
        </h1>
        <div class="post-info">
            
                <span class="date">2020-02-21</span>
            
            
            
                <span class="category">
                    <a href="/categories/笔记/">笔记</a>
                </span>
            
        </div>
    </div>

    <div class="content">

        <!-- Gallery -->
        

        <!-- Post Content -->
        <p>并行计算（Parallel Computing）是指同时使用多种计算资源解决计算问题的过程，是提高计算机系统计算速度和处理能力的一种有效手段。它的基本思想是用多个处理器来协同求解同一问题，即将被求解的问题分解成若干个部分，各部分均由一个独立的处理机来并行计算。</p>
<a id="more"></a>

<h1 id="在win-vs上运行MPI指令"><a href="#在win-vs上运行MPI指令" class="headerlink" title="在win+vs上运行MPI指令"></a>在win+vs上运行MPI指令</h1><p>配置就不记录了，网上有很多。</p>
<p>win+vs+MPI，不能像常规程序一样直接运行。</p>
<ol>
<li>先在vs里写好代码</li>
<li><strong>重新生成</strong>项目</li>
<li>找到<strong>项目名.exe</strong>所在文件夹</li>
<li><strong>Shift+鼠标右键</strong>，打开<strong>Powershell窗口</strong></li>
<li>输入命令（比如）： mpiexec -n 10 HelloWord_MPI.exe</li>
</ol>
<p>注意：</p>
<p>mpiexec是运行MPI并行程序的指令，基本格式为<br>mpiexec -n N ./xxxxxx<br>其中N是并行进程数，xxxxxx是并行程序名称。</p>
<h1 id="MPI"><a href="#MPI" class="headerlink" title="MPI"></a>MPI</h1><p>MPI是一个跨语言的通讯协议，用于编写并行计算机。</p>
<h2 id="6个基本函数"><a href="#6个基本函数" class="headerlink" title="6个基本函数"></a>6个基本函数</h2><p>理论上讲 MPI 的所有通信功能都可以使用它的6个基本函数来实现。</p>
<pre class=" language-c"><code class="language-c"><span class="token comment" spellcheck="true">//初始化</span>
<span class="token function">MPI_Init</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>argc<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">//MPI 结束调用</span>
<span class="token function">MPI_Finalize</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">/*
*获得进程的标识号
*保存在rank里
*/</span> 
<span class="token function">MPI_Comm_rank</span><span class="token punctuation">(</span>MPI_Comm comm<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">*</span>rank<span class="token punctuation">)</span>    

<span class="token comment" spellcheck="true">/*
*获得当前通信域中进程的个数
*保存在size里
*/</span>
<span class="token function">MPI_Comm_size</span><span class="token punctuation">(</span>MPI_Comm comm<span class="token punctuation">,</span><span class="token keyword">int</span> <span class="token operator">*</span>size<span class="token punctuation">)</span>    

<span class="token comment" spellcheck="true">//发送消息</span>
<span class="token function">MPI_Send</span><span class="token punctuation">(</span>Void <span class="token operator">*</span>buf<span class="token punctuation">,</span><span class="token keyword">int</span> count<span class="token punctuation">,</span>MPI_Datatype<span class="token punctuation">,</span><span class="token keyword">int</span> dest<span class="token punctuation">,</span><span class="token keyword">int</span> tag<span class="token punctuation">,</span>MPI_Comm comm<span class="token punctuation">)</span>    

<span class="token comment" spellcheck="true">//接受消息    </span>
<span class="token function">MPI_Recv</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token operator">*</span>buf<span class="token punctuation">,</span><span class="token keyword">int</span> count<span class="token punctuation">,</span>MPI_Datatype data<span class="token punctuation">,</span><span class="token keyword">int</span> source<span class="token punctuation">,</span><span class="token keyword">int</span> tag<span class="token punctuation">,</span>MPI_Comm comm<span class="token punctuation">,</span>MPI_Status <span class="token operator">*</span>status<span class="token punctuation">)</span>   </code></pre>
<h2 id="消息传递"><a href="#消息传递" class="headerlink" title="消息传递"></a>消息传递</h2><p>MPI 通过 <code>MPI_Send</code> 和 <code>MPI_Receive</code> 发送和接受消息。其中这两种属于阻塞通信，对于发送方来说，消息发送不出去就会一直等待，而对于接收方来说，接收不到消息就会一直等待。</p>
<p><code>MPI_Send</code> 各参数的含义：</p>
<ul>
<li><code>buf</code> - 发送缓冲区的起始位置</li>
<li><code>count</code> - 发送的数据个数</li>
<li><code>datatype</code> - 发送数据的数据类型</li>
<li><code>dest</code> - 目标进程标号</li>
<li><code>tag</code> - 消息标志</li>
<li><code>comm</code> - 通信域</li>
</ul>
<p><code>MPI_Recv</code> 各参数含义：</p>
<ul>
<li><code>buf</code> - 接受缓冲区地址</li>
<li><code>count</code> - 最多可接受的数据个数</li>
<li><code>datatype</code> - 接受的数据类型</li>
<li><code>source</code> - 发送数据的进程号</li>
<li><code>tag</code> - 消息标志</li>
<li><code>comm</code> - 通信域</li>
<li><code>status</code> - 返回状态</li>
</ul>
<p>发送和接受的时候是以指定的 datatype 为基本单位的，count 是 datatype 类型数据的数目。在接受数据时，接受缓冲区的长度可以大于发送数据的长度。但是 MPI 中没有数据截断，如果发送数据长度大于接受缓冲区的长度就会报错。</p>
<p>在 C 实现中，状态变量 <code>MPI_Status</code> 必须要包含 3 个信息：<code>MPI_SOURCE</code>, <code>MPI_TAG</code> 和 <code>MPI_ERROR</code>，除此之外还可以包含其它的附加域。</p>
<p>详细说明：</p>
<p>MPI_Send：</p>
<ul>
<li>void *buff：你要发送的变量。</li>
<li>int count：你发送的消息的个数（注意：不是长度，例如你要发送一个int整数，这里就填写1，如要是发送“hello”字符串，这里就填写6（C语言中字符串未有一个结束符，需要多一位））。</li>
<li>MPI_Datatype datatype：你要发送的数据类型，这里需要用MPI定义的数据类型，可在网上找到，在此不再罗列。</li>
<li>int dest：目的地进程号，你要发送给哪个进程，就填写目的进程的进程号。</li>
<li>int tag：消息标签，接收方需要有相同的消息标签才能接收该消息。</li>
<li>MPI_Comm comm：通讯域。表示你要向哪个组发送消息。</li>
</ul>
<p>MPI_Recv：</p>
<ul>
<li>void *buff：你接收到的消息要保存到哪个变量里。</li>
<li>int count：你接收消息的消息的个数（注意：不是长度，例如你要发送一个int整数，这里就填写1，如要是发送“hello”字符串，这里就填写6（C语言中字符串未有一个结束符，需要多一位））。它是接收数据长度的上界. 具体接收到的数据长度可通过调用MPI_Get_count 函数得到。</li>
<li>MPI_Datatype datatype：你要接收的数据类型，这里需要用MPI定义的数据类型，可在网上找到，在此不再罗列。</li>
<li>int source：接收端进程号，你要需要哪个进程接收消息就填写接收进程的进程号。</li>
<li>int tag：消息标签，需要与发送方的tag值相同的消息标签才能接收该消息。</li>
<li>MPI_Comm comm：通讯域。</li>
<li>MPI_Status *status：消息状态。接收函数返回时，将在这个参数指示的变量中存放实际接收消息的状态信息，包括消息的源进程标识，消息标签，包含的数据项个数等。</li>
</ul>
<h2 id="预定义数据类型"><a href="#预定义数据类型" class="headerlink" title="预定义数据类型"></a>预定义数据类型</h2><p>MPI 预定义了下面几种数据类型</p>
<table>
<thead>
<tr>
<th>MPI预定义数据类型</th>
<th>对应的C数据类型</th>
</tr>
</thead>
<tbody><tr>
<td>MPI_CHAR</td>
<td>signed char</td>
</tr>
<tr>
<td>MPI_SHORT</td>
<td>signed short int</td>
</tr>
<tr>
<td>MPI_INT</td>
<td>signed int</td>
</tr>
<tr>
<td>MPI_LONG</td>
<td>signed long int</td>
</tr>
<tr>
<td>MPI_LONG_LONG_INT</td>
<td>long long int (optional)</td>
</tr>
<tr>
<td>MPI_UNSIGNED_CHAR</td>
<td>unsigned char</td>
</tr>
<tr>
<td>MPI_UNSIGNED_SHORT</td>
<td>unsigned short int</td>
</tr>
<tr>
<td>MPI_UNSIGNED</td>
<td>unsigned int</td>
</tr>
<tr>
<td>MPI_UNSIGNED_LONG</td>
<td>unsigned long int</td>
</tr>
<tr>
<td>MPI_FLOAT</td>
<td>float</td>
</tr>
<tr>
<td>MPI_DOUBLE</td>
<td>double</td>
</tr>
<tr>
<td>MPI_LONG_DOUBLE</td>
<td>long double</td>
</tr>
<tr>
<td>MPI_BYTE</td>
<td>无</td>
</tr>
<tr>
<td>MPI_PACKED</td>
<td>无</td>
</tr>
</tbody></table>
<p>在传递信息的时候，要保证两个方面的类型匹配（除了 <code>MPI_BYTE</code> 和 <code>MPI_PACKED</code> ）：</p>
<ol>
<li>传输的数据类型和通信中声明的 MPI 类型要对应，即数据类型为 <code>int</code>， 那么通信时声明的数据类型就要为 <code>MPI_INT</code>。</li>
<li>发送方和接受方的类型要匹配</li>
</ol>
<p><code>MPI_BYTE</code> 和 <code>MPI_PACKED</code> 可以和任意以字节为单位的存储相匹配。 <code>MPI_BYTE</code> 可以用于不加修改的传送内存中的二进制值。</p>
<h2 id="任意源和任意标识"><a href="#任意源和任意标识" class="headerlink" title="任意源和任意标识"></a>任意源和任意标识</h2><p>在消息传递时，发送操作必须明确指定发送对象的进程标号和消息标识，但是接收消息时，可以通过使用 <code>MPI_ANY_SOURCE</code>和 <code>MPI_ANY_TAG</code> 来接受任意进程发送给本进程的消息，类似于通配符。<code>MPI_ANY_SOURCE</code> 和 <code>MPI_ANY_TAG</code> 可以同时使用或者分别单独使用。</p>
<h1 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h1><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"mpi.h"</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span><span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> rank<span class="token punctuation">;</span>
    <span class="token keyword">int</span> size<span class="token punctuation">;</span>
    <span class="token function">MPI_Init</span><span class="token punctuation">(</span> <span class="token operator">&amp;</span>argc<span class="token punctuation">,</span> <span class="token operator">&amp;</span>argv <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">MPI_Comm_rank</span><span class="token punctuation">(</span>MPI_COMM_WORLD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rank<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">MPI_Comm_size</span><span class="token punctuation">(</span>MPI_COMM_WORLD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span> <span class="token string">"Hello world from process %d of %d\n"</span><span class="token punctuation">,</span> rank<span class="token punctuation">,</span> size <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">MPI_Finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<pre><code>Hello world from process 0 of 1</code></pre><h1 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h1><h2 id="1-n号进程发送，0号进程接收"><a href="#1-n号进程发送，0号进程接收" class="headerlink" title="1-n号进程发送，0号进程接收"></a>1-n号进程发送，0号进程接收</h2><p>此为标准阻塞接收发送的方式</p>
<pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"mpi.h"</span></span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">*</span> argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">int</span> numprocs<span class="token punctuation">,</span> myid<span class="token punctuation">,</span> source<span class="token punctuation">;</span>
    MPI_Status status<span class="token punctuation">;</span>
    <span class="token keyword">char</span> message<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">MPI_Init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>argc<span class="token punctuation">,</span> <span class="token operator">&amp;</span>argv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">MPI_Comm_rank</span><span class="token punctuation">(</span>MPI_COMM_WORLD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>myid<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">MPI_Comm_size</span><span class="token punctuation">(</span>MPI_COMM_WORLD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>numprocs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>myid <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//非0号进程发送消息</span>
        <span class="token function">strcpy</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token string">"Hello World!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">MPI_Send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> MPI_CHAR<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span>
            MPI_COMM_WORLD<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>   <span class="token comment" spellcheck="true">// myid == 0，即0号进程接收消息</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>source <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> source <span class="token operator">&lt;</span> numprocs<span class="token punctuation">;</span> source<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">MPI_Recv</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> MPI_CHAR<span class="token punctuation">,</span> source<span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span>
                MPI_COMM_WORLD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"接收到第%d号进程发送的消息：%s\n"</span><span class="token punctuation">,</span> source<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">MPI_Finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment" spellcheck="true">/* end main */</span></code></pre>
<pre><code>PS F:\并行程序学习\HelloWord_MPI\X64\Debug&gt; mpiexec -n 4 HelloWord_MPI.exe
接收到第1号进程发送的消息：Hello World!
接收到第2号进程发送的消息：Hello World!
接收到第3号进程发送的消息：Hello World!
PS F:\并行程序学习\HelloWord_MPI\X64\Debug&gt; mpiexec -n 8 HelloWord_MPI.exe
接收到第1号进程发送的消息：Hello World!
接收到第2号进程发送的消息：Hello World!
接收到第3号进程发送的消息：Hello World!
接收到第4号进程发送的消息：Hello World!
接收到第5号进程发送的消息：Hello World!
接收到第6号进程发送的消息：Hello World!
接收到第7号进程发送的消息：Hello World!</code></pre><p>可以看到，当开启四线程运行时，1-3号进程发送消息，0号进程接收到消息并打印；当开启八线程运行时，1-7号进程发送消息，0号进程接收到消息并打印。</p>
<h2 id="线程依次传参"><a href="#线程依次传参" class="headerlink" title="线程依次传参"></a>线程依次传参</h2><pre class=" language-c"><code class="language-c"><span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property">#<span class="token directive keyword">include</span> <span class="token string">"mpi.h"</span></span>

<span class="token comment" spellcheck="true">/**
 * 数据传递
 *
 * 线程 i 向线程 i+1 传数据
 */</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> param<span class="token punctuation">;</span>
    <span class="token keyword">int</span> process_num<span class="token punctuation">;</span>
    <span class="token keyword">int</span> process_id<span class="token punctuation">;</span>
    MPI_Status status<span class="token punctuation">;</span>
    <span class="token function">MPI_Init</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">MPI_Comm_rank</span><span class="token punctuation">(</span>MPI_COMM_WORLD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>process_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">MPI_Comm_size</span><span class="token punctuation">(</span>MPI_COMM_WORLD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>process_num<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>process_id <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        param <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"rank 0 send rank 1: %d\n"</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">;</span>
        param<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token function">MPI_Send</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>param<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> MPI_INT<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> MPI_COMM_WORLD<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">MPI_Recv</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>param<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> MPI_INT<span class="token punctuation">,</span> process_id <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> MPI_COMM_WORLD<span class="token punctuation">,</span> <span class="token operator">&amp;</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"rank %d receive from %d: %d\n"</span><span class="token punctuation">,</span>process_id<span class="token punctuation">,</span> process_id<span class="token number">-1</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>process_id <span class="token operator">&lt;</span> process_num <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            param<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"rank %d send rank %d: %d\n"</span><span class="token punctuation">,</span> process_id<span class="token punctuation">,</span> process_id<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">MPI_Send</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>param<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> MPI_INT<span class="token punctuation">,</span> process_id <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> MPI_COMM_WORLD<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">MPI_Finalize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<pre><code>PS F:\并行程序学习\HelloWord_MPI\X64\Debug&gt; mpiexec -n 4 HelloWord_MPI.exe
rank 1 receive from 0: 4
rank 1 send rank 2: 5
rank 2 receive from 1: 5
rank 2 send rank 3: 6
rank 0 send rank 1: 3
rank 3 receive from 2: 6</code></pre><h1 id="通信类别"><a href="#通信类别" class="headerlink" title="通信类别"></a>通信类别</h1><p>对于 MPI 中的通信中，从通信对象方面看可以分为两类：</p>
<ul>
<li>点对点通信 - 只涉及发送方和接收方两个进程，并且发送和接收时要指明发送和接收的对象。在发送进程和接收进程里，两者的调用的函数也不相同。</li>
<li>组通信 - 一个特定组内的所有进程同时参与通信，并且组通信在每个进程中的调用方式完全一样。</li>
</ul>
<p>对于点对点通信来讲，从发送行为不同又可以分为下面三类：</p>
<ul>
<li>阻塞通信 - 在发送和接受操作完成之前，程序一直处于等待状态</li>
<li>非阻塞通信 - 无需等待发送和操作行为完成就可以返回，然后再调用特定的方法判断通信操作是否完成</li>
<li>重复非阻塞通信 - 针对一个通信被多次调用的情况（例如循环结构内的通信调用），重复利用通信对象，而不是每次都开启一个新的通信。单次的通信和非阻塞通信的行为相同。</li>
</ul>
<p>对于组通信来说，会为组内的进程隐式添加一个同步点，等到所有进程到达后再往下执行。在后面的文章我们会详细介绍上面提到的通信类别。</p>

    </div>

    

    
        <div class="post-tags">
            <i class="fa fa-tags" aria-hidden="true"></i>
            <a href="/tags/note/">#note</a> <a href="/tags/并行计算/">#并行计算</a> <a href="/tags/课程/">#课程</a>
        </div>
    

    <!-- Comments -->
    

</div>
        </section>

    </div>
</div>


</div>

<!-- Footer -->
<div class="push"></div>

<footer class="footer-content">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 footer-about">
                <h2>About</h2>
                <p>
                    This theme was developed by <a href="https://github.com/klugjo" target="_blank" rel="noopener">Jonathan Klughertz</a>. The source code is available on Github. Create Websites. Make Magic.
                </p>
            </div>
            
    <div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 recent-posts">
        <h2>Recent Posts</h2>
        <ul>
            
            <li>
                <a class="footer-post" href="/2020/05/31/hello-world/">Hello World</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/05/31/hadoop-xue-xi-zhi-topn/">Hadoop学习之TopN</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/05/31/hadoop-xue-xi-zhi-shu-ju-qu-chong/">Hadoop学习之数据去重</a>
            </li>
            
            <li>
                <a class="footer-post" href="/2020/05/30/ji-yu-vue-he-springboot-qian-hou-duan-fen-chi-de-tu-shu-guan-li-xi-tong/">基于Vue和SpringBoot前后端分离的图书管</a>
            </li>
            
        </ul>
    </div>



            
<div class="col-xs-6 col-sm-6 col-md-3 col-lg-3 footer-categories">
    <h2>Categories</h2>
    <ul>
        
        <li>
            <a class="footer-post" href="/categories/%E8%AE%B0%E5%BF%86/">记忆</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/java/">java</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/%E8%AE%B0%E5%BD%95/">记录</a>
        </li>
        
        <li>
            <a class="footer-post" href="/categories/%E6%9C%89%E6%84%9F%E8%80%8C%E5%8F%91/">有感而发</a>
        </li>
        
    </ul>
</div>

        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <ul class="list-inline footer-social-icons">
                    
                    <li class="list-inline-item">
                        <a href="https://github.com/klugjo/hexo-theme-alpha-dust" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-github"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://twitter.com/?lang=en" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-twitter"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.facebook.com/" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-facebook"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.instagram.com/" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-instagram"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://dribbble.com/" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-dribbble"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://plus.google.com/" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-google-plus"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://www.behance.net/" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-behance"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="https://500px.com/" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-500px"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="mailto:test@example.com" target="_blank" rel="noopener">
                            <span class="footer-icon-container">
                                <i class="fa fa-envelope-o"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li class="list-inline-item">
                        <a href="\#">
                            <span class="footer-icon-container">
                                <i class="fa fa-rss"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                <div class="footer-copyright">
                    @Untitled. All right reserved | Design & Hexo <a href="http://www.codeblocq.com/" target="_blank" rel="noopener">Jonathan Klughertz</a>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- After footer scripts -->

<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Tween Max -->
<script src="//cdnjs.cloudflare.com/ajax/libs/gsap/1.18.5/TweenMax.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Custom JavaScript -->
<script src="/js/main.js"></script>

<!-- Disqus Comments -->



</body>

</html>